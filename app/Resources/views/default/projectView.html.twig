{% extends 'base.html.twig' %}

{% block body %}
<div class="page-header text-center">
  <h1>{{ project.title|e }}</h1>
  <p>By {{ project.user.username }}</p>
  <p>It's my project : 
	{% if myproject %}
	<a class="" href="/user/project/{{ project_id }}/steps/publish">Add Steps</a>
	-
	<a class="" href="/user/project/{{ project_id }}/edit">Edit Project</a>
	{% endif %}
</p>
</div>

<div class="row">
	<div class="col-md-8 project-container">
		<div><img width="100%" src="{{ vich_uploader_asset(project, 'imageFile') }}" alt="{{ project.title }}"/></div>
		<div class="project-container-text">
			<div class="Project-shortdescription">
				<p>
				  {{ project.shortDescription|e }}
				</p>
				<p>TODO : Add Statistics and other infos HERE</p>
			</div>
			<hr>
			<h3>Full Description:</h3>
			<p>
			  {{ project.fullDescription|e }}
			</p>

			{% if project.videoUrl != '' %}
			<h3>Video:</h3>
			<iframe width="560" height="315" src="{{ project.videoUrl|e }}" frameborder="0" allowfullscreen></iframe>

			{% endif %}

			<h3>People needed:</h3>
			<p>
			  {{ project.team|e }}
			</p>

			<h3>Risks and Challenges:</h3>
			<p>
			  {{ project.risksChallenges|e }}
			</p>

			<h3>DeliveryPromise:</h3>
			<p>
			  {{ project.deliveryPromise|e }}
			</p>

			<p>
			Creation Date:????????
			</p>
		</div>
	</div>
	<div class="col-md-4">
		<div class="steps-sidebar">
		<h2>Steps{% if myproject %}<a href="/user/project/{{ project_id }}/steps/publish">+</a>{% endif %}</h2>
		{% for step in steps %}
			<div class="one-step {% if step.isCompleted %}completed{% elseif step.isDisplayPledgeForm %}inprogress{% else %}tocomplete{% endif %}">
			<h3>{{ step.title }}</h3> (price: {{ step.price }})
			<p>{{ step.shortDescription|e }}</p>
			<p>
			{% if step.isCompleted %}
			<span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
				<strong>Completed!</strong>
			{% elseif step.isDisplayPledgeForm %}
				{{ step.priceToFinish }} credit(s) remaining to achieve this step!
				{% if error == 1 %}
					<p><strong>Not enough credits available!</strong></p>
				{% endif %}
				<form action="/user/project/{{ project_id }}/pledge" method="post">
				<input type="number" id="price" name="price" required="required" class="form-control input-price" min="0" max="{{ userCredits.credits }}">
				<button type="submit" id="project_save" name="step" class="btn-success btn"><span class="glyphicon glyphicon-heart" aria-hidden="true"></span> Pledge</button>
				</form>
			{% else %}
				Coming next...
			{% endif %}
			</p>
			</div>
		{% endfor %}
		</div>
	</div>
</div>
{% endblock %}